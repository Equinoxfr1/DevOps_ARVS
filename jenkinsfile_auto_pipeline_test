pipeline {
    agent any
    
    stages {
        stage('Get Issues') {
            steps {
                script {
                    // Récupérer les issues via l'API GitHub avec curl en PowerShell
                    def response = powershell(script: 'curl -s https://api.github.com/repos/{propriétaire}/{nom_du_projet}/issues', returnStdout: true)
                    
                    // Utiliser PowerShell pour parser le JSON et obtenir les titres des issues
                    def issues = readJSON text: response
                    def issueTitles = issues.collect { it.title }

                    // Créer un stage pour chaque issue
                    issueTitles.each { issue ->
                        stage("Issue: ${issue}") {
                            steps {
                                echo "Handling issue: ${issue}"
                                // Ajouter ici les actions pour chaque issue
                            }
                        }
                    }
                }
            }
        }
    }
}
